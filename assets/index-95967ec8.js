import{B as b,d as W,r as c,c as X,C as Y,e as s,H as Z,o as y,f as C,g as a,w as r,x as ee,p as V,k as x,h as d,i as ae,z as U,v as z,D as _,_ as te}from"./index-8f68718e.js";const le=(m,n)=>b.get(`/admin/product/baseTrademark/${m}/${n}`),oe=m=>m.id?b.put("/admin/product/baseTrademark/update",m):b.post("/admin/product/baseTrademark/save",m),re=m=>b.delete("/admin/product/baseTrademark/remove/"+m),se=["src"],ne=["src"],ie=W({__name:"index",setup(m){let n=c(1),f=c(3),N=c(0),k=c([]),u=c(!1),o=X({tmName:"",logoUrl:""}),p=c();const g=async(t=1)=>{n.value=t;let e=await le(n.value,f.value);e.code==200&&(N.value=e.data.total,k.value=e.data.records)};Y(()=>{g()});const w=()=>{g()},h=()=>{u.value=!0,o.id=0,o.tmName="",o.logoUrl="",z(()=>{p.value.clearValidate("tmName"),p.value.clearValidate("logoUrl")})},O=t=>{z(()=>{p.value.clearValidate("tmName"),p.value.clearValidate("logoUrl")}),u.value=!0,Object.assign(o,t)},P=()=>{u.value=!1},q=async()=>{await p.value.validate(),(await oe(o)).code==200?(u.value=!1,_({type:"success",message:o.id?"修改品牌成功":"添加品牌成功"}),g(o.id?n.value:1)):(_({type:"error",message:o.id?"修改品牌失败":"添加品牌失败"}),u.value=!1)},D=t=>t.type=="image/png"||t.type=="image/jpeg"||t.type=="image/gif"?t.size/1024/1024<4?!0:(_({type:"error",message:"上传文件大小小于4M"}),!1):(_({type:"error",message:"上传文件格式务必PNG|JPG|GIF"}),!1),G=(t,e)=>{o.logoUrl=t.data,p.value.clearValidate("logoUrl")},E={tmName:[{required:!0,trigger:"blur",validator:(t,e,i)=>{e.trim().length>=2?i():i(new Error("品牌名称位数大于等于两位"))}}],logoUrl:[{required:!0,validator:(t,e,i)=>{e?i():i(new Error("LOGO图片务必上传"))}}]},L=async t=>{(await re(t)).code==200?(_({type:"success",message:"删除品牌成功"}),g(k.value.length>1?n.value:n.value-1)):_({type:"error",message:"删除品牌失败"})};return(t,e)=>{const i=s("el-button"),v=s("el-table-column"),A=s("el-popconfirm"),M=s("el-table"),$=s("el-pagination"),j=s("el-card"),B=s("el-input"),T=s("el-form-item"),H=s("Plus"),R=s("el-icon"),S=s("el-upload"),I=s("el-form"),J=s("el-dialog"),F=Z("has");return y(),C("div",null,[a(j,{class:"box-card"},{default:r(()=>[ee((y(),V(i,{type:"primary",size:"default",icon:"Plus",onClick:h},{default:r(()=>e[4]||(e[4]=[x(" 添加品牌 ")])),_:1})),[[F,"btn.Trademark.add"]]),a(M,{style:{margin:"10px 0px"},border:"",data:d(k)},{default:r(()=>[a(v,{label:"序号",width:"80px",align:"center",type:"index"}),a(v,{label:"品牌名称",prop:"tmName"}),a(v,{label:"品牌LOGO"},{default:r(({row:l,$index:K})=>[ae("img",{src:l.logoUrl,style:{width:"100px",height:"100px"}},null,8,se)]),_:1}),a(v,{label:"品牌操作"},{default:r(({row:l,$index:K})=>[a(i,{type:"primary",size:"small",icon:"Edit",onClick:Q=>O(l)},null,8,["onClick"]),a(A,{title:`您确定要删除${l.tmName}?`,width:"250px",icon:"Delete",onConfirm:Q=>L(l.id)},{reference:r(()=>[a(i,{type:"primary",size:"small",icon:"Delete"})]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),a($,{onSizeChange:w,onCurrentChange:g,"pager-count":9,"current-page":d(n),"onUpdate:currentPage":e[0]||(e[0]=l=>U(n)?n.value=l:n=l),"page-size":d(f),"onUpdate:pageSize":e[1]||(e[1]=l=>U(f)?f.value=l:f=l),"page-sizes":[3,5,7,9],background:!0,layout:"prev, pager, next, jumper,->,sizes,total",total:d(N)},null,8,["current-page","page-size","total"])]),_:1}),a(J,{modelValue:d(u),"onUpdate:modelValue":e[3]||(e[3]=l=>U(u)?u.value=l:u=l),title:d(o).id?"修改品牌":"添加品牌"},{footer:r(()=>[a(i,{type:"primary",size:"default",onClick:P},{default:r(()=>e[5]||(e[5]=[x(" 取消 ")])),_:1}),a(i,{type:"primary",size:"default",onClick:q},{default:r(()=>e[6]||(e[6]=[x(" 确定 ")])),_:1})]),default:r(()=>[a(I,{style:{width:"80%"},model:d(o),rules:E,ref_key:"formRef",ref:p},{default:r(()=>[a(T,{label:"品牌名称","label-width":"100px",prop:"tmName"},{default:r(()=>[a(B,{placeholder:"请您输入品牌名称",modelValue:d(o).tmName,"onUpdate:modelValue":e[2]||(e[2]=l=>d(o).tmName=l)},null,8,["modelValue"])]),_:1}),a(T,{label:"品牌LOGO","label-width":"100px",prop:"logoUrl"},{default:r(()=>[a(S,{class:"avatar-uploader",action:"/api/admin/product/fileUpload","show-file-list":!1,"on-success":G,"before-upload":D},{default:r(()=>[d(o).logoUrl?(y(),C("img",{key:0,src:d(o).logoUrl,class:"avatar"},null,8,ne)):(y(),V(R,{key:1,class:"avatar-uploader-icon"},{default:r(()=>[a(H)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}});const pe=te(ie,[["__scopeId","data-v-6bd50647"]]);export{pe as default};
