import{B as c,d as U,r as g,c as A,C as D,e as i,o as N,f as O,g as l,w as a,k as u,t as j,h as d,i as E,z as V,F,D as C}from"./index-8f68718e.js";const R=()=>c.get("/admin/acl/permission"),T=m=>m.id?c.put("/admin/acl/permission/update",m):c.post("/admin/acl/permission/save",m),H=m=>c.delete("/admin/acl/permission/remove/"+m),S={class:"dialog-footer"},I=U({__name:"index",setup(m){let _=g([]),n=g(!1),o=A({code:"",level:0,name:"",pid:0});D(()=>{f()});const f=async()=>{let s=await R();s.code==200&&(_.value=s.data)},k=s=>{Object.assign(o,{id:0,code:"",level:0,name:"",pid:0}),n.value=!0,o.level=s.level+1,o.pid=s.id},x=s=>{n.value=!0,Object.assign(o,s)},M=async()=>{(await T(o)).code==200&&(n.value=!1,C({type:"success",message:o.id?"更新成功":"添加成功"}),f())},P=async s=>{(await H(s)).code==200&&(C({type:"success",message:"删除成功"}),f())};return(s,e)=>{const p=i("el-table-column"),r=i("el-button"),$=i("el-popconfirm"),q=i("el-table"),v=i("el-input"),b=i("el-form-item"),z=i("el-form"),B=i("el-dialog");return N(),O(F,null,[l(q,{data:d(_),style:{width:"100%","margin-bottom":"20px"},"row-key":"id",border:""},{default:a(()=>[l(p,{label:"名称",prop:"name"}),l(p,{label:"权限值",prop:"code"}),l(p,{label:"修改时间",prop:"updateTime"}),l(p,{label:"操作"},{default:a(({row:t,$index:w})=>[l(r,{type:"primary",onClick:y=>k(t),size:"small",disabled:t.level==4},{default:a(()=>[u(j(t.level==3?"添加功能":"添加菜单"),1)]),_:2},1032,["onClick","disabled"]),l(r,{type:"primary",onClick:y=>x(t),size:"small",disabled:t.level==1},{default:a(()=>e[4]||(e[4]=[u("编辑")])),_:2},1032,["onClick","disabled"]),l($,{title:`你确定要删除${t.name}?`,width:"260px",onConfirm:y=>P(t.id)},{reference:a(()=>[l(r,{type:"primary",size:"small",disabled:t.level==1},{default:a(()=>e[5]||(e[5]=[u("删除")])),_:2},1032,["disabled"])]),_:2},1032,["title","onConfirm"])]),_:1})]),_:1},8,["data"]),l(B,{modelValue:d(n),"onUpdate:modelValue":e[3]||(e[3]=t=>V(n)?n.value=t:n=t),title:d(o).id?"更新菜单":"添加菜单"},{footer:a(()=>[E("span",S,[l(r,{onClick:e[2]||(e[2]=t=>V(n)?n.value=!1:n=!1)},{default:a(()=>e[6]||(e[6]=[u("取消")])),_:1}),l(r,{type:"primary",onClick:M},{default:a(()=>e[7]||(e[7]=[u(" 确定 ")])),_:1})])]),default:a(()=>[l(z,null,{default:a(()=>[l(b,{label:"名称"},{default:a(()=>[l(v,{placeholder:"请你输入菜单名称",modelValue:d(o).name,"onUpdate:modelValue":e[0]||(e[0]=t=>d(o).name=t)},null,8,["modelValue"])]),_:1}),l(b,{label:"权限"},{default:a(()=>[l(v,{placeholder:"请你输入权限数值",modelValue:d(o).code,"onUpdate:modelValue":e[1]||(e[1]=t=>d(o).code=t)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1},8,["modelValue","title"])],64)}}});export{I as default};
